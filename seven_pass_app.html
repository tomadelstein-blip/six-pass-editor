<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seven-Pass Auto-Correction Engine - Voice Preserving</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .tool-section {
            margin-bottom: 40px;
        }

        .section-title {
            font-size: 1.4em;
            color: #2c3e50;
            margin-bottom: 15px;
            border-left: 4px solid #3498db;
            padding-left: 15px;
        }

        .textarea-container {
            position: relative;
            margin-bottom: 20px;
        }

        textarea {
            width: 100%;
            min-height: 300px;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        textarea:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin: 30px 0;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(52, 152, 219, 0.3);
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
            transform: translateY(-2px);
        }

        .btn-success {
            background: linear-gradient(135deg, #27ae60, #229954);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(39, 174, 96, 0.3);
        }

        .pass-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }

        .pass-btn {
            padding: 10px 15px;
            background: linear-gradient(135deg, #27ae60, #229954);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pass-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(39, 174, 96, 0.3);
        }

        .statistics {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin: 25px 0;
            border-left: 5px solid #3498db;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #3498db;
            display: block;
        }

        .stat-label {
            color: #7f8c8d;
            font-size: 0.9em;
            margin-top: 5px;
        }

        .changes-log {
            background: #fff9c4;
            padding: 20px;
            border-radius: 10px;
            margin: 25px 0;
            border-left: 5px solid #f39c12;
            max-height: 300px;
            overflow-y: auto;
        }

        .change-item {
            margin: 8px 0;
            padding: 8px 12px;
            background: white;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            border-left: 3px solid #f39c12;
        }

        .warning {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #dc3545;
        }

        .methodology {
            background: #f8f9fa;
            padding: 30px;
            margin: 30px 0;
            border-radius: 10px;
            border-left: 5px solid #e74c3c;
        }

        .methodology h3 {
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .methodology ol {
            padding-left: 20px;
        }

        .methodology li {
            margin: 8px 0;
            color: #555;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Seven-Pass Auto-Correction Engine</h1>
            <p>Voice-preserving mechanical execution of Tom Adelstein's proven editorial methodology</p>
        </div>

        <div class="content">
            <div class="warning">
                <strong>ðŸ”§ Fixed Version:</strong> This version preserves your authentic voice by removing the destructive verb replacements that turned natural language into robotic prose. Only truly weak constructions are targeted.
            </div>

            <div class="tool-section">
                <h2 class="section-title">Input Text</h2>
                <div class="textarea-container">
                    <textarea id="inputText" placeholder="Paste your text here for automatic seven-pass correction..."></textarea>
                </div>
            </div>

            <div class="controls">
                <button class="btn btn-primary" onclick="runAllPasses()">Run All 7 Passes</button>
                <button class="btn btn-secondary" onclick="clearAll()">Clear All</button>
                <button class="btn btn-success" onclick="copyOutput()">Copy Corrected Text</button>
                <button class="btn btn-secondary" onclick="loadSample()">Load Sample Text</button>
            </div>

            <div class="pass-controls">
                <button class="pass-btn" onclick="runPass(1)">Pass 1: Passive Voice</button>
                <button class="pass-btn" onclick="runPass(2)">Pass 2: Remove Adverbs</button>
                <button class="pass-btn" onclick="runPass(3)">Pass 3: Sentence Length</button>
                <button class="pass-btn" onclick="runPass(4)">Pass 4: Redundant Modifiers</button>
                <button class="pass-btn" onclick="runPass(5)">Pass 5: Personal Voice</button>
                <button class="pass-btn" onclick="runPass(6)">Pass 6: Fix Weak Verbs</button>
                <button class="pass-btn" onclick="runPass(7)">Pass 7: Imperative Mood</button>
            </div>

            <div class="statistics hidden" id="statistics">
                <h3>Processing Statistics</h3>
                <div class="stats-grid" id="statsContent"></div>
            </div>

            <div class="changes-log hidden" id="changesLog">
                <h3>Changes Made</h3>
                <div id="changesContent"></div>
            </div>

            <div class="tool-section">
                <h2 class="section-title">Corrected Text</h2>
                <div style="background: #d1ecf1; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #bee5eb;">
                    <strong>âœ… Voice Preserved:</strong> This version maintains your natural conversational tone while fixing mechanical violations. Your authentic voice remains intact.
                </div>
                <div class="textarea-container">
                    <textarea id="outputText" readonly placeholder="Corrected text will appear here..."></textarea>
                </div>
            </div>

            <div class="methodology">
                <h3>The Seven-Pass Methodology (Voice-Preserving)</h3>
                <ol>
                    <li><strong>Passive Voice Detection:</strong> Identify and mark passive constructions for manual review</li>
                    <li><strong>Adverb Removal:</strong> Remove "-ly" modifiers that weaken prose (preserves essential ones)</li>
                    <li><strong>Sentence Length Control:</strong> Break sentences over 17 words for optimal readability</li>
                    <li><strong>Redundant Modifier Stripping:</strong> Remove qualifiers that add no information</li>
                    <li><strong>Personal Voice Consistency:</strong> Ensure first-person narrative throughout</li>
                    <li><strong>Weak Verb Fixing:</strong> Target only genuinely pompous/bureaucratic language</li>
                    <li><strong>Imperative Mood Conversion:</strong> Transform prose into actionable methodology</li>
                </ol>
            </div>
        </div>
    </div>

    <script>
        let currentText = '';
        let changes = [];
        let stats = {
            passiveVoiceFixed: 0,
            adverbsRemoved: 0,
            sentencesShortened: 0,
            modifiersRemoved: 0,
            verbsStrengthened: 0,
            personalVoiceFixed: 0,
            imperativeConverted: 0,
            totalChanges: 0
        };

        // FIXED: Only target genuinely weak, pompous verbs - preserve natural voice
        const weakVerbs = {
            'utilize': 'use',
            'facilitate': 'help',
            'implement': 'do',
            'commence': 'start',
            'terminate': 'end',
            'initiate': 'begin',
            'endeavor': 'try',
            'accomplish': 'do',
            'acquire': 'get',
            'demonstrate': 'show',
            'indicate': 'show',
            'establish': 'set up',
            'maintain': 'keep',
            'participate': 'join',
            'contribute': 'give',
            'require': 'need',
            'assist': 'help',
            'attempt': 'try',
            'generate': 'create',
            'purchase': 'buy',
            'sufficient': 'enough',
            'numerous': 'many',
            'additional': 'more',
            'previous': 'earlier'
        };

        // Redundant modifiers to remove
        const redundantModifiers = [
            'very', 'quite', 'rather', 'really', 'extremely', 'incredibly', 'amazingly', 
            'absolutely', 'completely', 'totally', 'utterly', 'entirely', 'wholly',
            'somewhat', 'fairly', 'pretty', 'kind of', 'sort of', 'a bit', 'a little',
            'basically', 'essentially', 'actually', 'literally', 'definitely',
            'obviously', 'clearly', 'certainly', 'undoubtedly', 'particularly',
            'especially', 'specifically', 'precisely'
        ];

        function runPass(passNumber) {
            const input = document.getElementById('inputText').value;
            if (!input.trim()) {
                alert('Please enter some text first.');
                return;
            }

            currentText = input;
            changes = [];
            
            switch(passNumber) {
                case 1:
                    currentText = fixPassiveVoice(currentText);
                    break;
                case 2:
                    currentText = removeAdverbs(currentText);
                    break;
                case 3:
                    currentText = shortenSentences(currentText);
                    break;
                case 4:
                    currentText = removeRedundantModifiers(currentText);
                    break;
                case 5:
                    currentText = ensurePersonalVoice(currentText);
                    break;
                case 6:
                    currentText = fixWeakVerbs(currentText);
                    break;
                case 7:
                    currentText = convertToImperative(currentText);
                    break;
            }

            document.getElementById('outputText').value = currentText;
            updateDisplay();
        }

        function runAllPasses() {
            const input = document.getElementById('inputText').value;
            if (!input.trim()) {
                alert('Please enter some text first.');
                return;
            }

            currentText = input;
            changes = [];
            stats = {
                passiveVoiceFixed: 0,
                adverbsRemoved: 0,
                sentencesShortened: 0,
                modifiersRemoved: 0,
                verbsStrengthened: 0,
                personalVoiceFixed: 0,
                imperativeConverted: 0,
                totalChanges: 0
            };

            // Run all passes in sequence
            currentText = fixPassiveVoice(currentText);
            currentText = removeAdverbs(currentText);
            currentText = shortenSentences(currentText);
            currentText = removeRedundantModifiers(currentText);
            currentText = ensurePersonalVoice(currentText);
            currentText = fixWeakVerbs(currentText);
            currentText = convertToImperative(currentText);

            document.getElementById('outputText').value = currentText;
            updateDisplay();
        }

        function fixPassiveVoice(text) {
            let result = text;
            
            // Detect passive voice patterns
            result = result.replace(/\b(was|were|is|are|am|be|been|being)\s+(\w+ed)\b/gi, (match, auxVerb, pastParticiple) => {
                // Skip common exceptions that aren't passive voice
                if (pastParticiple.toLowerCase() === 'used' || 
                    pastParticiple.toLowerCase() === 'based' ||
                    pastParticiple.toLowerCase() === 'focused') {
                    return match;
                }
                
                stats.passiveVoiceFixed++;
                changes.push(`Pass 1 - Passive voice detected: "${match}"`);
                return `[PASSIVE: ${match} - convert to active voice]`;
            });

            return result;
        }

        function removeAdverbs(text) {
            let result = text;
            
            // Keep essential adverbs that are necessary for meaning
            const keepAdverbs = [
                'early', 'daily', 'monthly', 'yearly', 'quarterly', 'weekly',
                'supply', 'family', 'holy', 'only', 'likely', 'timely',
                'hardly', 'nearly', 'barely', 'mostly', 'usually', 'always',
                'never', 'often', 'sometimes', 'rarely', 'frequently',
                'immediately', 'suddenly', 'gradually', 'slowly', 'quickly',
                'directly', 'indirectly', 'recently', 'currently', 'previously',
                'finally', 'initially', 'eventually', 'instantly'
            ];
            
            result = result.replace(/\b\w+ly\b/g, (match) => {
                if (keepAdverbs.includes(match.toLowerCase())) {
                    return match;
                }
                
                stats.adverbsRemoved++;
                changes.push(`Pass 2 - Removed adverb: "${match}"`);
                return '';
            });

            // Clean up extra spaces
            result = result.replace(/([^\n\r]) {2,}([^\n\r])/g, '$1 $2');
            
            return result;
        }

        function shortenSentences(text) {
            let result = text;
            const sentences = result.split(/([.!?]+)/);
            
            let newSentences = [];
            for (let i = 0; i < sentences.length; i += 2) {
                const sentence = sentences[i];
                const punctuation = sentences[i + 1] || '';
                
                if (sentence && sentence.trim()) {
                    const words = sentence.trim().split(/\s+/);
                    if (words.length > 17) {
                        stats.sentencesShortened++;
                        changes.push(`Pass 3 - Long sentence (${words.length} words): "${sentence.trim().substring(0, 50)}..."`);
                        
                        // Split at logical points
                        let splitSentence = sentence.replace(/,\s+(and|but|or|yet|so|because|since|while|although|though|however)\s+/gi, '$1 ');
                        newSentences.push(splitSentence + punctuation);
                    } else {
                        newSentences.push(sentence + punctuation);
                    }
                }
            }
            
            return newSentences.join('');
        }

        function removeRedundantModifiers(text) {
            let result = text;
            
            redundantModifiers.forEach(modifier => {
                const regex = new RegExp(`\\b${modifier}\\s+`, 'gi');
                result = result.replace(regex, (match) => {
                    stats.modifiersRemoved++;
                    changes.push(`Pass 4 - Removed redundant modifier: "${match.trim()}"`);
                    return '';
                });
            });

            // Clean up extra spaces
            result = result.replace(/([^\n\r]) {2,}([^\n\r])/g, '$1 $2');
            return result;
        }

        function ensurePersonalVoice(text) {
            let result = text;
            
            // Convert third person to first person (minimal changes)
            const conversions = [
                ['the author', 'I'],
                ['one can see', 'I see'],
                ['it is possible to see', 'I see'],
                ['one should note', 'note'],
                ['it should be noted', 'note']
            ];

            conversions.forEach(([from, to]) => {
                const regex = new RegExp(`\\b${from}\\b`, 'gi');
                result = result.replace(regex, (match) => {
                    stats.personalVoiceFixed++;
                    changes.push(`Pass 5 - Personal voice: "${match}" â†’ "${to}"`);
                    return to;
                });
            });
            
            return result;
        }

        function fixWeakVerbs(text) {
            let result = text;
            
            // FIXED: Only replace genuinely pompous/bureaucratic language
            Object.keys(weakVerbs).forEach(weakVerb => {
                const strongVerb = weakVerbs[weakVerb];
                const regex = new RegExp(`\\b${weakVerb}\\b`, 'gi');
                
                result = result.replace(regex, (match) => {
                    stats.verbsStrengthened++;
                    changes.push(`Pass 6 - Simplified: "${match}" â†’ "${strongVerb}"`);
                    return strongVerb;
                });
            });
            
            return result;
        }

        function convertToImperative(text) {
            let result = text;
            
            // Convert wordy constructions to direct commands
            const imperativeConversions = [
                ['you should try to ', ''],
                ['you need to make sure to ', ''],
                ['it is important to remember to ', ''],
                ['make sure that you ', ''],
                ['be sure to ', '']
            ];

            imperativeConversions.forEach(([from, to]) => {
                const regex = new RegExp(from, 'gi');
                result = result.replace(regex, (match) => {
                    stats.imperativeConverted++;
                    changes.push(`Pass 7 - Imperative: "${match}" â†’ "${to}"`);
                    return to;
                });
            });
            
            return result;
        }

        function updateDisplay() {
            stats.totalChanges = stats.passiveVoiceFixed + stats.adverbsRemoved + 
                               stats.sentencesShortened + stats.modifiersRemoved + 
                               stats.verbsStrengthened + stats.personalVoiceFixed + 
                               stats.imperativeConverted;

            // Show statistics
            const statsDiv = document.getElementById('statistics');
            const statsContent = document.getElementById('statsContent');
            statsContent.innerHTML = `
                <div class="stat-item">
                    <span class="stat-number">${stats.passiveVoiceFixed}</span>
                    <div class="stat-label">Passive Voice</div>
                </div>
                <div class="stat-item">
                    <span class="stat-number">${stats.adverbsRemoved}</span>
                    <div class="stat-label">Adverbs Removed</div>
                </div>
                <div class="stat-item">
                    <span class="stat-number">${stats.sentencesShortened}</span>
                    <div class="stat-label">Sentences Shortened</div>
                </div>
                <div class="stat-item">
                    <span class="stat-number">${stats.modifiersRemoved}</span>
                    <div class="stat-label">Modifiers Removed</div>
                </div>
                <div class="stat-item">
                    <span class="stat-number">${stats.verbsStrengthened}</span>
                    <div class="stat-label">Verbs Simplified</div>
                </div>
                <div class="stat-item">
                    <span class="stat-number">${stats.personalVoiceFixed}</span>
                    <div class="stat-label">Voice Fixed</div>
                </div>
                <div class="stat-item">
                    <span class="stat-number">${stats.imperativeConverted}</span>
                    <div class="stat-label">Imperative Mood</div>
                </div>
                <div class="stat-item">
                    <span class="stat-number">${stats.totalChanges}</span>
                    <div class="stat-label">Total Changes</div>
                </div>
            `;
            statsDiv.classList.remove('hidden');

            // Show changes log
            if (changes.length > 0) {
                const changesDiv = document.getElementById('changesLog');
                const changesContent = document.getElementById('changesContent');
                changesContent.innerHTML = changes.map(change => 
                    `<div class="change-item">${change}</div>`
                ).join('');
                changesDiv.classList.remove('hidden');
            }
        }

        function clearAll() {
            document.getElementById('inputText').value = '';
            document.getElementById('outputText').value = '';
            document.getElementById('statistics').classList.add('hidden');
            document.getElementById('changesLog').classList.add('hidden');
            currentText = '';
            changes = [];
            stats = {
                passiveVoiceFixed: 0,
                adverbsRemoved: 0,
                sentencesShortened: 0,
                modifiersRemoved: 0,
                verbsStrengthened: 0,
                personalVoiceFixed: 0,
                imperativeConverted: 0,
                totalChanges: 0
            };
        }

        function copyOutput() {
            const outputText = document.getElementById('outputText');
            outputText.select();
            outputText.setSelectionRange(0, 99999);
            document.execCommand('copy');
            
            // Show feedback
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = 'Copied!';
            btn.style.background = '#27ae60';
            setTimeout(() => {
                btn.textContent = originalText;
                btn.style.background = '';
            }, 2000);
        }

        function loadSample() {
            const sampleText = `I was really very excited to completely demonstrate this absolutely amazing discovery. The research that was conducted by scientists definitely shows that people should basically try to essentially utilize what was found. This extremely important finding will totally revolutionize how we actually think about the incredibly complex process that was previously quite mysterious.`;
            
            document.getElementById('inputText').value = sampleText;
        }

        // Auto-resize textareas
        function autoResize() {
            const textareas = document.querySelectorAll('textarea');
            textareas.forEach(textarea => {
                textarea.addEventListener('input', function() {
                    this.style.height = 'auto';
                    this.style.height = this.scrollHeight + 'px';
                });
            });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', autoResize);
    </script>
</body>
</html>
